# سامانهٔ طراحی آپاتی – فاز یک

این بستهٔ فرانت‌اند با محوریت React + Vite پیاده‌سازی شده و فاز نخست از برنامهٔ سامانهٔ طراحی را پوشش می‌دهد. دسترس‌پذیری، بومی‌سازی فارسی و زیرساخت لایهٔ سرویس از ابتدا در نظر گرفته شده‌اند.

## راه‌اندازی

```bash
npm install
npm run dev
```

### اسکریپت‌های اصلی

- `npm run dev` – اجرای محیط توسعه Vite.
- `npm run build` – تولید خروجی production با TypeScript build check.
- `npm run lint` – بررسی استانداردهای ESLint و فرمت.
- `npm run test` – اجرای Vitest (واحد + شبیه‌سازی شبکه با MSW).

## ساختار شاخص کد

```
src/
 ├─ app/                 # ریشهٔ اپلیکیشن و نمایشی از توکن‌ها
 ├─ design/
 │   ├─ tokens/          # توکن‌های رنگ، تایپوگرافی، فاصله، شعاع و سایه
 │   └─ theme/           # ThemeProvider و مدیریت متغیرهای CSS
 ├─ i18n/                # پیکربندی i18next و مدیریت جهت صفحه
 ├─ services/http/       # لایهٔ شبکه مبتنی بر axios با نوسازی JWT
 ├─ shared/intl/         # تبدیل اعداد و تاریخ به قالب فارسی/بین‌المللی
 └─ styles/              # استایل‌های سراسری متکی بر توکن‌ها
```

## طراحی و تم‌ها

- توکن‌های بصری در `src/design/tokens/index.ts` تعریف شده‌اند (تم روشن/تیره، شبکهٔ فاصله‌گذاری ۴/۸ پیکسلی، سایه‌ها و شعاع گوشه).
- `ThemeProvider` متغیرهای CSS را به `document.documentElement` تزریق و وضعیت تم را در سراسر اپ همگام می‌کند.
- مثال‌های تعاملی برای تایپوگرافی، فاصله و سایه در `src/app/App.tsx` موجود است.

## بومی‌سازی و تارگت فارسی

- `LocalizationProvider` زبان، جهت صفحه و locale dayjs را به صورت خودکار به‌روزرسانی می‌کند.
- ماژول `src/shared/intl/format.ts` تبدیل اعداد (۴۸ → ۴۸) و تاریخ‌ها به جلالی را فراهم کرده و در UI نمونه‌سازی شده است.

## لایهٔ سرویس و احراز هویت

- `src/services/http/client.ts` یک `axios` instance با:
  - افزودن هدر Authorization بر اساس توکن‌های ذخیره‌شده،
  - نوسازی خودکار JWT هنگام دریافت ۴۰۱ و صف‌بندی درخواست‌های هم‌زمان،
  - کنترل خطا و همگام‌سازی توکن‌ها با localStorage.
- تست‌های رفتاری در `client.test.ts` تضمین‌کنندهٔ صحت نوسازی، درج هدر و پاک‌سازی توکن‌ها هستند.

## مستندسازی

- `docs/api-contracts-fa.md` – قراردادهای اصلی API بک‌اند و مسیرهای احراز هویت.
- `docs/phase-one-report.md` – خروجی‌های فاز یک و وضعیت چک‌فهرست پذیرش.

## گام‌های بعدی پیشنهادی

1. توسعهٔ کتابخانهٔ مولفه‌ها (دکمه، ورودی، کارت، اعلان، نشانگر بارگذاری) بر اساس توکن‌ها.
2. تکمیل Storybook/Documentation برای نمایش حالات و الگوها.
3. اتصال صفحات کاربردی به API واقعی طبق قراردادهای ثبت‌شده.
